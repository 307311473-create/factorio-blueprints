<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Factorio è“å›¾åº“</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; max-width: 800px; margin: 2rem auto; padding: 0 1rem; }
    h1 { text-align: center; color: #333; }
    input { width: 100%; padding: 0.75rem; margin: 1rem 0; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
    .result { border: 1px solid #eee; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
    .result h3 { margin-top: 0; color: #0066cc; }
    .result a { color: #d73a49; text-decoration: none; }
    .result a:hover { text-decoration: underline; }
    .loading { text-align: center; color: #666; }
  </style>
</head>
<body>
  <h1>ğŸ” Factorio è“å›¾æœç´¢</h1>
  <input type="text" id="searchInput" placeholder="è¾“å…¥å…³é”®è¯ï¼ˆå¦‚ steam, belt, train...ï¼‰">

  <div id="results" class="loading">æ­£åœ¨åŠ è½½è“å›¾...</div>

  <script>
    async function loadBlueprints() {
      try {
        const response = await fetch('blueprints.json');
        if (!response.ok) throw new Error('æ— æ³•åŠ è½½ blueprints.json');
        const blueprints = await response.json();
        return blueprints;
      } catch (error) {
        document.getElementById('results').innerHTML = `<p style="color:red">âŒ ${error.message}</p>`;
        return [];
      }
    }

    function renderResults(blueprints, query = '') {
      const resultsDiv = document.getElementById('results');
      if (!query.trim()) {
        resultsDiv.innerHTML = '<p>è¯·è¾“å…¥å…³é”®è¯è¿›è¡Œæœç´¢...</p>';
        return;
      }

      const q = query.toLowerCase();
      const filtered = blueprints.filter(bp =>
        bp.name?.toLowerCase().includes(q) ||
        bp.description?.toLowerCase().includes(q) ||
        bp.author?.toLowerCase().includes(q)
      );

      if (filtered.length === 0) {
        resultsDiv.innerHTML = '<p>æœªæ‰¾åˆ°åŒ¹é…çš„è“å›¾ ğŸ˜¢</p>';
        return;
      }

      resultsDiv.innerHTML = filtered.slice(0, 50).map(bp => `
        <div class="result">
          <h3>${bp.name || 'æ— æ ‡é¢˜'}</h3>
          <p>${bp.description || ''}</p>
          <p><strong>ä½œè€…:</strong> ${bp.author || 'æœªçŸ¥'}</p>
          <a href="${bp.url}" target="_blank" rel="noopener">ğŸ”— æŸ¥çœ‹è“å›¾</a>
        </div>
      `).join('');
    }

    // åˆå§‹åŒ–
    let allBlueprints = [];
    loadBlueprints().then(data => {
      allBlueprints = data;
      document.getElementById('results').innerHTML = '<p>âœ… è“å›¾åŠ è½½å®Œæˆï¼è¯·è¾“å…¥å…³é”®è¯æœç´¢ã€‚</p>';
    });

    // æœç´¢
    document.getElementById('searchInput').addEventListener('input', (e) => {
      renderResults(allBlueprints, e.target.value);
    });
  </script>
</body>
</html>
